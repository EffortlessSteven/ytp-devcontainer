{
  "packages": [
    "rustup",
    "gcc@latest"
  ],
  "shell": {
    "init_hook": [
      "echo '[Devbox Init Hook] Shell for ytp-devcontainer activated.'",
      "RUST_VERSION_FROM_FILE=$(grep '^channel *=' rust-toolchain.toml | cut -d '\"' -f 2)",
      "echo \"[Devbox Init Hook] Target Rust version from rust-toolchain.toml: $RUST_VERSION_FROM_FILE\"",
      "if ! rustup toolchain list | grep -q \"^${RUST_VERSION_FROM_FILE}-\"; then rustup toolchain install \"$RUST_VERSION_FROM_FILE\" --profile minimal --component clippy --component rustfmt; fi",
      "rustup default \"$RUST_VERSION_FROM_FILE\"",
      "echo '[Devbox Init Hook] Active toolchain details:'",
      "rustc --version || echo 'WARNING: rustc not found in PATH!'",
      "cargo --version || echo 'WARNING: cargo not found in PATH!'",
      "export CARGO_TERM_COLOR=always"
    ],
    "scripts": {
      "perform_initial_project_setup": "echo '[Devbox Script: perform_initial_project_setup] Fetching Rust dependencies...' && cargo fetch && echo '[Devbox Script: perform_initial_project_setup] Dependencies fetched.'",
      "test": "cargo test --all-targets --all-features",
      "test-release": "cargo test --all-targets --all-features --release",
      "build": "cargo build --release",
      "build-debug": "cargo build",
      "clippy": "cargo clippy --all-targets --all-features -- -D warnings",
      "fmt": "cargo fmt --all",
      "fmt_check": "cargo fmt --all -- --check",
      "bench": "cargo bench",
      "doc": "cargo doc --no-deps --open",
      "clean": "cargo clean",
      "ci": [
        "echo '[CI] Running format check...'",
        "cargo fmt --all -- --check",
        "echo '[CI] Running clippy...'", 
        "cargo clippy --all-targets --all-features -- -D warnings",
        "echo '[CI] Running tests...'",
        "cargo test --all-targets --all-features",
        "echo '[CI] Building release...'",
        "cargo build --release",
        "echo '[CI] All checks passed!'"
      ]
    }
  }
} 